{"version":3,"file":"submit.js","sources":["../../../node_modules/d3-selection/src/selectAll.js","../../../scripts/submit.js"],"sourcesContent":["import {Selection, root} from \"./selection/index\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([document.querySelectorAll(selector)], [document.documentElement])\n      : new Selection([selector == null ? [] : selector], root);\n}\n","// packages\nimport 'intersection-observer';\nimport yall from 'yall-js';\nimport * as d3 from 'd3';\n\nconsole.log('submit page');\nif (sessionStorage.getItem(\"logger\")) {\n  document.getElementById('logger').value = sessionStorage.getItem(\"logger\");\n}\n\nif (sessionStorage.getItem(\"neighborhood\")) {\n  document.getElementById('neighborhood').value = sessionStorage.getItem(\"neighborhood\");\n}\n\nconst form = document.getElementById('form-submit');\nconst formToJSON = (elements) =>\n  [].reduce.call(\n    elements,\n    (data, element) => {\n      if (element.type === 'radio') {\n        if (element.checked) {\n          data[element.name] = element.value;\n        }\n      } else {\n        data[element.name] = element.value;\n      }\n      return data;\n    },\n    {}\n  );\n\nconst post = (formJSON) => {\n  fetch('https://bwb9uvadvf.execute-api.us-west-1.amazonaws.com/prod/people', {\n    method: 'POST',\n    body: JSON.stringify(formJSON),\n  }).then((response) => {\n    console.log(response);\n    location.reload();\n  });\n};\n\nconst submitForm = (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n  e.stopImmediatePropagation();\n\n  let formJSON = formToJSON(form.elements);\n\n  const date = new Date();\n  const getMonth = (month) => {\n    if (month < 10) {\n      return `0${month}`;\n    } else {\n      return month;\n    }\n  };\n  const getFullDate = `${date.getFullYear()}-${getMonth(\n    date.getMonth() + 1\n  )}-${date.getDate()}`;\n\n  formJSON.date = getFullDate;\n  formJSON.time = date;\n\n  if(formJSON.logger.length > 0 && formJSON.logger !== sessionStorage.getItem(\"logger\")){\n    sessionStorage.setItem('logger', formJSON.logger);\n  }\n\n  if(formJSON.neighborhood.length > 0 && formJSON.neighborhood !== sessionStorage.getItem(\"neighborhood\")){\n    sessionStorage.setItem('neighborhood', formJSON.neighborhood);\n  }\n\n  if(formJSON.logger.length === 0 || formJSON.neighborhood.length === 0){\n    d3.select('.exp.error').classed('show', true);\n    if(formJSON.logger.length === 0){\n      d3.select('#logger').classed('error', true);\n    } else {\n      d3.select('#logger').classed('error', false);\n    }\n    if(formJSON.neighborhood.length === 0){\n      d3.select('#neighborhood').classed('error', true);\n    } else {\n      d3.select('#neighborhood').classed('error', false);\n    }\n  } else {\n    d3.select('.exp.error').classed('show', false);\n    d3.selectAll('input').classed('error', false);\n    post(formJSON);\n  }\n};\n\nform.addEventListener('submit', submitForm);\n"],"names":["console","log","sessionStorage","getItem","document","getElementById","value","form","formToJSON","elements","reduce","call","data","element","type","checked","name","post","formJSON","fetch","method","body","JSON","stringify","then","response","location","reload","submitForm","e","preventDefault","stopPropagation","stopImmediatePropagation","date","Date","getMonth","month","getFullDate","getFullYear","getDate","time","logger","length","setItem","neighborhood","d3","classed","addEventListener"],"mappings":"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"}