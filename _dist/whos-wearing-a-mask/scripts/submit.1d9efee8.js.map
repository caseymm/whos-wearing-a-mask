{"version":3,"file":"submit.1d9efee8.js","sources":["../../../scripts/submit.js","../../../node_modules/d3-selection/src/selectAll.js"],"sourcesContent":["// packages\nimport 'intersection-observer';\nimport yall from 'yall-js';\nimport * as d3 from 'd3';\n\nconsole.log('submit page');\nif (sessionStorage.getItem(\"logger\")) {\n  document.getElementById('logger').value = sessionStorage.getItem(\"logger\");\n}\n\nif (sessionStorage.getItem(\"neighborhood\")) {\n  document.getElementById('neighborhood').value = sessionStorage.getItem(\"neighborhood\");\n}\n\nconst form = document.getElementById('form-submit');\nconst formToJSON = (elements) =>\n  [].reduce.call(\n    elements,\n    (data, element) => {\n      if (element.type === 'radio') {\n        if (element.checked) {\n          data[element.name] = element.value;\n        }\n      } else {\n        data[element.name] = element.value;\n      }\n      return data;\n    },\n    {}\n  );\n\nconst post = (formJSON) => {\n  fetch('https://bwb9uvadvf.execute-api.us-west-1.amazonaws.com/prod/people', {\n    method: 'POST',\n    body: JSON.stringify(formJSON),\n  }).then((response) => {\n    console.log(response);\n    location.reload();\n  });\n};\n\nconst submitForm = (e) => {\n  e.preventDefault();\n  e.stopPropagation();\n  e.stopImmediatePropagation();\n\n  let formJSON = formToJSON(form.elements);\n\n  const date = new Date();\n  const getMonth = (month) => {\n    if (month < 10) {\n      return `0${month}`;\n    } else {\n      return month;\n    }\n  };\n  const getFullDate = `${date.getFullYear()}-${getMonth(\n    date.getMonth() + 1\n  )}-${date.getDate()}`;\n\n  formJSON.date = getFullDate;\n  formJSON.time = date;\n\n  if(formJSON.logger.length > 0 && formJSON.logger !== sessionStorage.getItem(\"logger\")){\n    sessionStorage.setItem('logger', formJSON.logger);\n  }\n\n  if(formJSON.neighborhood.length > 0 && formJSON.neighborhood !== sessionStorage.getItem(\"neighborhood\")){\n    sessionStorage.setItem('neighborhood', formJSON.neighborhood);\n  }\n\n  if(formJSON.logger.length === 0 || formJSON.neighborhood.length === 0){\n    d3.select('.exp.error').classed('show', true);\n    if(formJSON.logger.length === 0){\n      d3.select('#logger').classed('error', true);\n    } else {\n      d3.select('#logger').classed('error', false);\n    }\n    if(formJSON.neighborhood.length === 0){\n      d3.select('#neighborhood').classed('error', true);\n    } else {\n      d3.select('#neighborhood').classed('error', false);\n    }\n  } else {\n    d3.select('.exp.error').classed('show', false);\n    d3.selectAll('input').classed('error', false);\n    post(formJSON);\n  }\n};\n\nform.addEventListener('submit', submitForm);\n","import {Selection, root} from \"./selection/index\";\n\nexport default function(selector) {\n  return typeof selector === \"string\"\n      ? new Selection([document.querySelectorAll(selector)], [document.documentElement])\n      : new Selection([selector == null ? [] : selector], root);\n}\n"],"names":["console","log","sessionStorage","getItem","document","getElementById","value","form","addEventListener","e","preventDefault","stopPropagation","stopImmediatePropagation","formJSON","elements","reduce","call","data","element","type","checked","name","date","Date","getFullDate","getFullYear","month","getMonth","getDate","selector","time","logger","length","setItem","neighborhood","d3","classed","Selection","querySelectorAll","documentElement","root","fetch","method","body","JSON","stringify","then","response","location","reload","post"],"mappings":"0DAKAA,QAAQC,IAAI,eACRC,eAAeC,QAAQ,YACzBC,SAASC,eAAe,UAAUC,MAAQJ,eAAeC,QAAQ,WAG/DD,eAAeC,QAAQ,kBACzBC,SAASC,eAAe,gBAAgBC,MAAQJ,eAAeC,QAAQ,iBAGzE,MAAMI,EAAOH,SAASC,eAAe,eA4ErCE,EAAKC,iBAAiB,SAjDFC,IAClBA,EAAEC,iBACFD,EAAEE,kBACFF,EAAEG,+BAEEC,GA/BcC,EA+BQP,EAAKO,SA9B/B,GAAGC,OAAOC,KACRF,EACA,CAACG,EAAMC,KACgB,UAAjBA,EAAQC,KACND,EAAQE,UACVH,EAAKC,EAAQG,MAAQH,EAAQZ,OAG/BW,EAAKC,EAAQG,MAAQH,EAAQZ,MAExBW,GAET,KAbgBH,IAAAA,QAiCZQ,EAAO,IAAIC,KAQXC,EAAe,GAAEF,EAAKG,iBAPVC,EAQhBJ,EAAKK,WAAa,EAPdD,EAAQ,GACF,IAAGA,EAEJA,KAKNJ,EAAKM,YATQF,IAAAA,EC/CIG,ED0DtBhB,EAASS,KAAOE,EAChBX,EAASiB,KAAOR,EAEbT,EAASkB,OAAOC,OAAS,GAAKnB,EAASkB,SAAW7B,eAAeC,QAAQ,WAC1ED,eAAe+B,QAAQ,SAAUpB,EAASkB,QAGzClB,EAASqB,aAAaF,OAAS,GAAKnB,EAASqB,eAAiBhC,eAAeC,QAAQ,iBACtFD,eAAe+B,QAAQ,eAAgBpB,EAASqB,cAGpB,IAA3BrB,EAASkB,OAAOC,QAAiD,IAAjCnB,EAASqB,aAAaF,QACvDG,EAAU,cAAcC,QAAQ,QAAQ,GACV,IAA3BvB,EAASkB,OAAOC,OACjBG,EAAU,WAAWC,QAAQ,SAAS,GAEtCD,EAAU,WAAWC,QAAQ,SAAS,GAEJ,IAAjCvB,EAASqB,aAAaF,OACvBG,EAAU,iBAAiBC,QAAQ,SAAS,GAE5CD,EAAU,iBAAiBC,QAAQ,SAAS,KAG9CD,EAAU,cAAcC,QAAQ,QAAQ,IClFpBP,EDmFP,QClFY,iBAAbA,EACR,IAAIQ,EAAU,CAACjC,SAASkC,iBAAiBT,IAAY,CAACzB,SAASmC,kBAC/D,IAAIF,EAAU,CAAa,MAAZR,EAAmB,GAAKA,GAAWW,IDgFhCJ,QAAQ,SAAS,GAtD7BvB,CAAAA,IACZ4B,MAAM,qEAAsE,CAC1EC,OAAQ,OACRC,KAAMC,KAAKC,UAAUhC,KACpBiC,KAAMC,IACP/C,QAAQC,IAAI8C,GACZC,SAASC,YAiDTC,CAAKrC"}